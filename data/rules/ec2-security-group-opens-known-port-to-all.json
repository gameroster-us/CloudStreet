{
    "arg_names": [ "Network protocol name", "Transport protocol name", "Port number" ],
    "key": "ec2-security-group-opens-port-to-all",
    "description": "Security Group known Ports Open to All",
    "description_detail": "Rules with source of 0.0.0.0/0 allow all IP addresses to access your instance. We recommend setting security group rules to allow access from known IP addresses only.",
    "dashboard_name": "Rules",
    "path": "ec2.regions.id.vpcs.id.security_groups.id.rules.id.protocols.id.ports.id.cidrs.id.CIDR",
    "display_path": "ec2.regions.id.vpcs.id.security_groups.id",
    "property": "ip_permissions",
    "conditions": [ "and",
        [ "ip_permission['ipRanges'][0]['cidrIp']", "equal", "'0.0.0.0/0'" ],        
        [ "ip_permission['ipProtocol']", "includes", "_ARG_0_"],
        [ "ip_permission['fromPort']", "equal" ,"ip_permission['toPort']"],
        [ ["ip_permission['fromPort']","ip_permission['toPort']"], "containAtLeastOneOf", [20, 21, 22, 23, 25, 53, 80, 135, 137, 138, 139, 443, 445, 1433, 1521, 3306, 3389, 5432, 9200, 27017] ]
    ]
}
